# Guide de Test en DÃ©veloppement - SystÃ¨me d'Abonnement

Guide Ã©tape par Ã©tape pour tester le systÃ¨me d'abonnement en local avant le dÃ©ploiement en production.

---

## ðŸŽ¯ Objectif

Valider que tous les composants du systÃ¨me d'abonnement fonctionnent correctement:
- âœ… Checkout Stripe
- âœ… Webhooks
- âœ… Emails
- âœ… Protection d'accÃ¨s
- âœ… Cron job

**DurÃ©e estimÃ©e:** 30-45 minutes

---

## PrÃ©requis

- [ ] Compte Stripe (gratuit): https://dashboard.stripe.com/register
- [ ] Compte Resend (gratuit): https://resend.com/signup
- [ ] Stripe CLI installÃ© (nous allons l'installer ensemble)
- [ ] Application Next.js dÃ©marrÃ©e en local

---

## Ã‰tape 1: Configuration Stripe (Mode Test)

### 1.1 CrÃ©er un Compte Stripe

1. Aller sur https://dashboard.stripe.com/register
2. CrÃ©er un compte (gratuit, aucune carte requise)
3. Activer le mode **Test** (toggle en haut Ã  droite)

### 1.2 RÃ©cupÃ©rer les ClÃ©s API de Test

1. Dans le dashboard Stripe, aller dans **DÃ©veloppeurs â†’ ClÃ©s API**
2. Copier:
   - **ClÃ© publiable**: `pk_test_...`
   - **ClÃ© secrÃ¨te**: `sk_test_...` (cliquer sur "RÃ©vÃ©ler la clÃ© de test")

### 1.3 CrÃ©er les Produits et Prix de Test

#### Option A: Via le Dashboard Stripe (RecommandÃ© pour dÃ©butants)

1. Aller dans **Catalogue de produits â†’ Produits**
2. Cliquer sur **+ Ajouter un produit**

**Produit 1: Plan Mensuel**
```
Nom: Health In Cloud - Mensuel
Description: AccÃ¨s complet aux exercices de rÃ©Ã©ducation
Prix: 19.00 EUR
Facturation rÃ©currente: Mensuelle
Essai gratuit: 14 jours
```
3. Cliquer sur **Enregistrer le produit**
4. Copier l'ID du prix (commence par `price_...`)

**Produit 2: Plan Annuel**
```
Nom: Health In Cloud - Annuel
Description: AccÃ¨s complet aux exercices de rÃ©Ã©ducation
Prix: 180.00 EUR
Facturation rÃ©currente: Annuelle
Essai gratuit: 14 jours
```
5. Cliquer sur **Enregistrer le produit**
6. Copier l'ID du prix (commence par `price_...`)

#### Option B: Via Stripe CLI (AvancÃ©)

Si vous avez dÃ©jÃ  Stripe CLI installÃ©:

```bash
# CrÃ©er le produit
stripe products create \
  --name="Health In Cloud Premium" \
  --description="AccÃ¨s complet aux exercices de rÃ©Ã©ducation"

# Copier le product ID (prod_xxx)

# CrÃ©er le prix mensuel avec essai
stripe prices create \
  --product=prod_xxx \
  --unit-amount=1900 \
  --currency=eur \
  --recurring[interval]=month \
  --recurring[trial_period_days]=14

# Copier le price ID â†’ STRIPE_PRICE_MONTHLY

# CrÃ©er le prix annuel avec essai
stripe prices create \
  --product=prod_xxx \
  --unit-amount=18000 \
  --currency=eur \
  --recurring[interval]=year \
  --recurring[trial_period_days]=14

# Copier le price ID â†’ STRIPE_PRICE_YEARLY
```

---

## Ã‰tape 2: Configuration Resend (Emails)

### 2.1 CrÃ©er un Compte Resend

1. Aller sur https://resend.com/signup
2. CrÃ©er un compte (gratuit, 100 emails/jour, 3000/mois)
3. VÃ©rifier votre email

### 2.2 RÃ©cupÃ©rer la ClÃ© API

1. Dans le dashboard Resend, aller dans **API Keys**
2. Cliquer sur **Create API Key**
3. Nom: `Health In Cloud Dev`
4. Permission: **Sending access**
5. Copier la clÃ© (commence par `re_...`)

### 2.3 Configuration de l'Email ExpÃ©diteur

En mode dÃ©veloppement, Resend permet d'envoyer depuis `onboarding@resend.dev`.

Pour utiliser votre propre domaine (optionnel):
1. Aller dans **Domains**
2. Ajouter votre domaine
3. Configurer les enregistrements DNS
4. Attendre la vÃ©rification (~5 minutes)

---

## Ã‰tape 3: Variables d'Environnement

### 3.1 CrÃ©er/Mettre Ã  Jour `.env.local`

CrÃ©er ou Ã©diter le fichier `.env.local` Ã  la racine du projet:

```bash
# Stripe (Mode Test)
STRIPE_SECRET_KEY=sk_test_...                          # ClÃ© secrÃ¨te de l'Ã©tape 1.2
NEXT_PUBLIC_STRIPE_PUBLIC_KEY=pk_test_...              # ClÃ© publique de l'Ã©tape 1.2
STRIPE_PRICE_MONTHLY=price_...                         # ID prix mensuel de l'Ã©tape 1.3
STRIPE_PRICE_YEARLY=price_...                          # ID prix annuel de l'Ã©tape 1.3
STRIPE_WEBHOOK_SECRET=whsec_...                        # Sera gÃ©nÃ©rÃ© Ã  l'Ã©tape 4

# Resend (Emails)
RESEND_API_KEY=re_...                                  # ClÃ© API de l'Ã©tape 2.2
RESEND_FROM_EMAIL=onboarding@resend.dev                # Email par dÃ©faut Resend

# Cron Job
CRON_SECRET=dev_test_secret_123                        # Secret pour tester le cron en local

# Application
NEXT_PUBLIC_APP_URL=http://localhost:3000

# Base de donnÃ©es (dÃ©jÃ  configurÃ© normalement)
DATABASE_URL=postgresql://...
DIRECT_URL=postgresql://...
```

### 3.2 VÃ©rifier les Variables

```bash
# VÃ©rifier que toutes les variables sont prÃ©sentes
cat .env.local | grep -E "(STRIPE|RESEND|CRON)"
```

Vous devriez voir:
- âœ… `STRIPE_SECRET_KEY=sk_test_...`
- âœ… `NEXT_PUBLIC_STRIPE_PUBLIC_KEY=pk_test_...`
- âœ… `STRIPE_PRICE_MONTHLY=price_...`
- âœ… `STRIPE_PRICE_YEARLY=price_...`
- âœ… `RESEND_API_KEY=re_...`
- âœ… `RESEND_FROM_EMAIL=onboarding@resend.dev`
- âœ… `CRON_SECRET=dev_test_secret_123`

---

## Ã‰tape 4: Installer et Configurer Stripe CLI

Le Stripe CLI permet d'Ã©couter les webhooks en local.

### 4.1 Installer Stripe CLI

#### macOS (Homebrew)
```bash
brew install stripe/stripe-cli/stripe
```

#### Linux
```bash
# TÃ©lÃ©charger depuis https://github.com/stripe/stripe-cli/releases
wget https://github.com/stripe/stripe-cli/releases/download/v1.19.5/stripe_1.19.5_linux_x86_64.tar.gz
tar -xvf stripe_1.19.5_linux_x86_64.tar.gz
sudo mv stripe /usr/local/bin/
```

#### Windows
```powershell
# Via Scoop
scoop bucket add stripe https://github.com/stripe/scoop-stripe-cli.git
scoop install stripe
```

### 4.2 Se Connecter Ã  Stripe

```bash
stripe login
```

Cela ouvrira votre navigateur pour autoriser Stripe CLI.

### 4.3 Tester l'Installation

```bash
stripe --version
# Devrait afficher: stripe version 1.x.x
```

---

## Ã‰tape 5: DÃ©marrer l'Application

### 5.1 Appliquer les Migrations

```bash
# Appliquer la migration Subscription
npx prisma migrate dev

# Optionnel: Ouvrir Prisma Studio pour voir la DB
npx prisma studio
```

### 5.2 DÃ©marrer le Serveur Next.js

Dans un terminal:

```bash
npm run dev
```

L'application devrait dÃ©marrer sur http://localhost:3000

### 5.3 DÃ©marrer Stripe CLI pour les Webhooks

Dans un **deuxiÃ¨me terminal**:

```bash
stripe listen --forward-to localhost:3000/api/webhooks/stripe
```

Vous devriez voir:
```
> Ready! You are using Stripe API Version [2024-11-20.acacia]. Your webhook signing secret is whsec_... (^C to quit)
```

**Important:** Copier le `whsec_...` et l'ajouter dans `.env.local`:

```bash
STRIPE_WEBHOOK_SECRET=whsec_...
```

Puis **redÃ©marrer** le serveur Next.js (Ctrl+C puis `npm run dev`).

---

## Ã‰tape 6: Tests Manuels

### 6.1 Test du Flow de Checkout Complet

#### 1. CrÃ©er un Compte

1. Aller sur http://localhost:3000/fr
2. Cliquer sur **S'inscrire**
3. CrÃ©er un compte:
   ```
   Nom: Test User
   Email: test@example.com
   Mot de passe: TestPassword123!
   ```
4. Vous devriez Ãªtre redirigÃ© vers `/fr/dashboard`

#### 2. VÃ©rifier le Blocage (Pas d'Abonnement)

1. Vous devriez Ãªtre redirigÃ© automatiquement vers `/fr/subscription?blocked=true`
2. VÃ©rifier que l'alerte rouge apparaÃ®t:
   > "L'accÃ¨s aux exercices nÃ©cessite un abonnement actif"

#### 3. Voir les Plans Tarifaires

VÃ©rifier que la page affiche:
- âœ… Plan Mensuel: 19â‚¬/mois
- âœ… Plan Annuel: 180â‚¬/an (badge "Ã‰conomisez 21%")
- âœ… "14 jours d'essai gratuit" sur les deux
- âœ… Liste des fonctionnalitÃ©s
- âœ… Bouton "Commencer l'essai gratuit"

#### 4. DÃ©marrer un Checkout

1. Cliquer sur **Commencer l'essai gratuit** (plan mensuel)
2. Vous devriez Ãªtre redirigÃ© vers Stripe Checkout
3. VÃ©rifier l'URL: `https://checkout.stripe.com/c/pay/...`

#### 5. Remplir le Checkout Stripe

Utiliser les **cartes de test Stripe**:

**Carte de test (succÃ¨s):**
```
NumÃ©ro: 4242 4242 4242 4242
Date: N'importe quelle date future (ex: 12/25)
CVC: N'importe quel 3 chiffres (ex: 123)
Nom: Test User
Email: test@example.com
```

Cliquer sur **S'abonner**

#### 6. VÃ©rifier le Webhook

Dans le terminal Stripe CLI, vous devriez voir:

```
[200] POST /api/webhooks/stripe [evt_xxx] checkout.session.completed
[200] POST /api/webhooks/stripe [evt_xxx] customer.subscription.created
```

Les codes `[200]` indiquent que les webhooks ont Ã©tÃ© traitÃ©s avec succÃ¨s.

#### 7. Page de SuccÃ¨s

Vous devriez Ãªtre redirigÃ© vers `/fr/subscription/success`

VÃ©rifier:
- âœ… Message de fÃ©licitations
- âœ… Mention de l'essai gratuit
- âœ… Bouton "AccÃ©der au tableau de bord"

#### 8. VÃ©rifier l'AccÃ¨s au Dashboard

1. Cliquer sur **AccÃ©der au tableau de bord**
2. Vous devriez voir `/fr/dashboard` (pas de redirection cette fois!)
3. VÃ©rifier que vous pouvez accÃ©der aux exercices

#### 9. VÃ©rifier l'Abonnement en Base de DonnÃ©es

Dans Prisma Studio (http://localhost:5555):

1. Ouvrir la table **Subscription**
2. Trouver votre abonnement
3. VÃ©rifier:
   - âœ… `status` = "TRIALING"
   - âœ… `trialEnd` = date dans 14 jours
   - âœ… `stripeSubscriptionId` rempli
   - âœ… `stripePriceId` correspond au prix choisi

#### 10. VÃ©rifier dans Stripe Dashboard

1. Ouvrir https://dashboard.stripe.com/test/subscriptions
2. Voir votre abonnement de test
3. VÃ©rifier:
   - âœ… Statut: "En pÃ©riode d'essai"
   - âœ… Prochaine facturation: dans 14 jours
   - âœ… Montant: 19â‚¬

### 6.2 Test de la Gestion d'Abonnement

#### 1. AccÃ©der Ã  la Page Subscription

1. Aller sur http://localhost:3000/fr/subscription
2. VÃ©rifier que la carte d'abonnement s'affiche:
   - âœ… Badge "Essai" (couleur bleue)
   - âœ… "Votre essai se termine dans 14 jours"
   - âœ… Plan: "Mensuel - 19â‚¬/mois"
   - âœ… Bouton "GÃ©rer l'abonnement"

#### 2. Ouvrir le Customer Portal

1. Cliquer sur **GÃ©rer l'abonnement**
2. Vous devriez Ãªtre redirigÃ© vers Stripe Customer Portal
3. URL: `https://billing.stripe.com/p/session/...`

#### 3. Tester l'Annulation

Dans le Customer Portal:
1. Cliquer sur **Annuler l'abonnement**
2. Choisir **Annuler Ã  la fin de la pÃ©riode**
3. Confirmer

Retourner sur http://localhost:3000/fr/subscription

VÃ©rifier:
- âœ… Badge "AnnulÃ©"
- âœ… Message: "Votre abonnement sera annulÃ© le [date]"
- âœ… "Vous avez toujours accÃ¨s jusqu'au..."

### 6.3 Test des DiffÃ©rents Statuts

#### Tester le Paiement Ã‰chouÃ©

1. CrÃ©er un nouveau compte
2. DÃ©marrer un checkout
3. Utiliser la carte **Ã©chec de paiement**:
   ```
   NumÃ©ro: 4000 0000 0000 0341
   Date: Future
   CVC: 123
   ```

Le checkout devrait afficher une erreur de carte refusÃ©e.

#### Simuler un Ã‰chec de Paiement AprÃ¨s l'Essai

En dÃ©veloppement, le plus simple est de modifier manuellement la DB:

```sql
-- Dans Prisma Studio ou via psql
UPDATE "Subscription"
SET
  status = 'PAST_DUE',
  "currentPeriodEnd" = NOW() - INTERVAL '2 days'
WHERE "userId" = 'votre_user_id';
```

Puis retourner sur `/fr/subscription` et vÃ©rifier:
- âœ… Alerte rouge "ProblÃ¨me de paiement"
- âœ… Bouton "Mettre Ã  jour le moyen de paiement"
- âœ… AccÃ¨s maintenu (pÃ©riode de grÃ¢ce)

---

## Ã‰tape 7: Tester les Emails

### 7.1 DÃ©clencher un Email de Test

Nous allons tester l'email de paiement Ã©chouÃ©.

#### Option A: Via le Webhook (RecommandÃ©)

1. S'assurer que Stripe CLI Ã©coute les webhooks
2. DÃ©clencher un Ã©vÃ©nement de test:

```bash
# Dans un troisiÃ¨me terminal
stripe trigger invoice.payment_failed
```

VÃ©rifier:
- âœ… Dans le terminal Stripe CLI: `[200] POST /api/webhooks/stripe`
- âœ… Dans les logs de Next.js: Message de log de l'email envoyÃ©
- âœ… Dans Resend Dashboard: Email apparaÃ®t dans les logs

#### Option B: Via un Script de Test

CrÃ©er un fichier de test:

```typescript
// scripts/test-email.ts
import { sendPaymentFailedEmail } from '@/lib/email'

async function testEmail() {
  await sendPaymentFailedEmail({
    to: 'votre-email@example.com',  // Votre vrai email
    userName: 'Test User',
    amount: '19â‚¬',
    reason: 'Carte refusÃ©e',
    gracePeriodEnd: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toLocaleDateString('fr-FR'),
    locale: 'fr',
  })
  console.log('Email envoyÃ©!')
}

testEmail()
```

ExÃ©cuter:
```bash
npx tsx scripts/test-email.ts
```

### 7.2 VÃ©rifier l'Email ReÃ§u

1. Ouvrir votre boÃ®te mail
2. Chercher l'email de `onboarding@resend.dev`
3. VÃ©rifier:
   - âœ… Sujet: "Action requise : Ã‰chec du paiement"
   - âœ… Contenu personnalisÃ© (nom, montant, raison)
   - âœ… Bouton "Mettre Ã  jour le moyen de paiement"
   - âœ… Rendu correct (texte lisible, images chargÃ©es)
   - âœ… Version mobile responsive

### 7.3 Tester les Autres Templates

MÃªme processus pour:
- `sendTrialEndingEmail`
- `sendTrialEndedEmail`
- `sendRenewalReminderEmail`

---

## Ã‰tape 8: Tester le Cron Job

Le cron job s'exÃ©cute quotidiennement en production, mais nous pouvons le tester manuellement.

### 8.1 CrÃ©er des DonnÃ©es de Test

Dans Prisma Studio ou via SQL:

```sql
-- Abonnement se terminant dans 3 jours (pour rappel fin d'essai)
UPDATE "Subscription"
SET
  status = 'TRIALING',
  "trialEnd" = NOW() + INTERVAL '3 days'
WHERE "userId" = 'user_id_1';

-- Abonnement se renouvelant dans 7 jours (pour rappel renouvellement)
UPDATE "Subscription"
SET
  status = 'ACTIVE',
  "currentPeriodEnd" = NOW() + INTERVAL '7 days',
  "cancelAtPeriodEnd" = false
WHERE "userId" = 'user_id_2';
```

### 8.2 Appeler le Cron Manuellement

```bash
curl -X GET http://localhost:3000/api/cron/subscription-notifications \
  -H "Authorization: Bearer dev_test_secret_123"
```

### 8.3 VÃ©rifier la RÃ©ponse

Vous devriez recevoir:

```json
{
  "success": true,
  "trialEndingReminders": 1,
  "trialEndedNotifications": 0,
  "renewalReminders": 1,
  "errors": []
}
```

### 8.4 VÃ©rifier les Emails EnvoyÃ©s

VÃ©rifier dans votre boÃ®te mail que vous avez reÃ§u:
- âœ… Email "Votre essai gratuit se termine dans 3 jours"
- âœ… Email "Rappel : Votre abonnement sera renouvelÃ© prochainement"

---

## Ã‰tape 9: Tester les Cas d'Erreur

### 9.1 Webhook avec Signature Invalide

```bash
# Envoyer un webhook sans signature valide
curl -X POST http://localhost:3000/api/webhooks/stripe \
  -H "Content-Type: application/json" \
  -H "stripe-signature: invalid_signature" \
  -d '{"type":"test","data":{}}'
```

Devrait retourner: `400 Invalid signature`

### 9.2 Cron sans Authentification

```bash
# Appeler le cron sans le header Authorization
curl -X GET http://localhost:3000/api/cron/subscription-notifications
```

Devrait retourner: `401 Unauthorized`

### 9.3 Checkout sans ÃŠtre ConnectÃ©

1. Se dÃ©connecter
2. Aller sur http://localhost:3000/fr/subscription
3. Cliquer sur "Commencer l'essai"
4. Devrait rediriger vers `/fr/auth/login`

---

## Ã‰tape 10: Tester les Tests AutomatisÃ©s

### 10.1 Tests Unitaires

```bash
# ExÃ©cuter tous les tests unitaires
npm test

# ExÃ©cuter uniquement les tests de subscription
npm test -- subscription

# Avec coverage
npm run test:coverage
```

VÃ©rifier:
- âœ… Tous les tests passent
- âœ… Coverage > 90% sur `lib/subscription.ts`

### 10.2 Tests E2E

**Important:** Les tests E2E nÃ©cessitent que l'app soit dÃ©marrÃ©e.

```bash
# ExÃ©cuter les tests E2E
npm run test:e2e -- subscription.spec.ts

# Mode interactif (recommandÃ© pour dÃ©boguer)
npm run test:e2e:ui
```

Dans l'interface Playwright:
1. SÃ©lectionner `subscription.spec.ts`
2. Cliquer sur "Run" ou sur un test spÃ©cifique
3. Observer le navigateur exÃ©cuter les actions

**Note:** Certains tests nÃ©cessitent des mocks et peuvent Ã©chouer en dev. C'est normal, ils sont conÃ§us pour CI/CD.

---

## Checklist de Validation ComplÃ¨te

Avant de considÃ©rer les tests terminÃ©s, vÃ©rifier:

### Configuration
- [ ] Stripe Dashboard accessible en mode test
- [ ] 2 prix crÃ©Ã©s (monthly + yearly) avec essai 14 jours
- [ ] Resend configurÃ© avec clÃ© API valide
- [ ] Toutes les variables dans `.env.local`
- [ ] Stripe CLI installÃ© et connectÃ©

### Flow Utilisateur
- [ ] Signup crÃ©Ã© avec succÃ¨s
- [ ] Redirection vers `/subscription?blocked=true` sans abonnement
- [ ] Pricing table affichÃ©e correctement
- [ ] Checkout Stripe fonctionne (carte test 4242...)
- [ ] Webhooks reÃ§us et traitÃ©s (codes 200)
- [ ] Redirection vers `/subscription/success`
- [ ] AccÃ¨s au dashboard autorisÃ© aprÃ¨s checkout
- [ ] Abonnement visible en DB avec status TRIALING

### Gestion d'Abonnement
- [ ] Carte d'abonnement affichÃ©e sur `/subscription`
- [ ] Customer Portal accessible
- [ ] Annulation fonctionne
- [ ] Statut mis Ã  jour aprÃ¨s annulation

### Emails
- [ ] Email de paiement Ã©chouÃ© reÃ§u
- [ ] Rendu correct (texte + boutons)
- [ ] Liens fonctionnels
- [ ] Version FR correcte

### Cron Job
- [ ] Endpoint protÃ©gÃ© par Bearer token
- [ ] Emails de rappel envoyÃ©s pour les bons abonnements
- [ ] RÃ©ponse JSON correcte

### Tests AutomatisÃ©s
- [ ] Tests unitaires passent (npm test)
- [ ] Tests E2E passent (npm run test:e2e)

### Erreurs
- [ ] Webhook signature invalide â†’ 400
- [ ] Cron sans auth â†’ 401
- [ ] Checkout sans connexion â†’ redirect login

---

## DÃ©pannage

### ProblÃ¨me: "STRIPE_WEBHOOK_SECRET is not defined"

**Cause:** Variable d'environnement manquante

**Solution:**
1. VÃ©rifier que Stripe CLI est dÃ©marrÃ©: `stripe listen --forward-to localhost:3000/api/webhooks/stripe`
2. Copier le `whsec_...` affichÃ©
3. L'ajouter dans `.env.local`
4. **RedÃ©marrer** Next.js

### ProblÃ¨me: Webhooks retournent 400 ou 500

**Cause:** Signature invalide ou erreur de code

**Solution:**
1. VÃ©rifier les logs de Next.js pour voir l'erreur exacte
2. S'assurer que `STRIPE_WEBHOOK_SECRET` correspond au secret de Stripe CLI
3. VÃ©rifier que le body est lu en `text()` et non en JSON

### ProblÃ¨me: Emails non reÃ§us

**Causes possibles:**
1. ClÃ© API Resend invalide
2. Email dans les spams
3. Quota Resend dÃ©passÃ© (100/jour en gratuit)

**Solution:**
1. VÃ©rifier la clÃ© dans `.env.local`
2. Checker le dashboard Resend â†’ Logs
3. VÃ©rifier les spams
4. Utiliser votre vrai email, pas `test@example.com`

### ProblÃ¨me: "Cannot read property 'status' of null"

**Cause:** Abonnement non crÃ©Ã© en DB aprÃ¨s checkout

**Solution:**
1. VÃ©rifier que les webhooks sont reÃ§us (terminal Stripe CLI)
2. VÃ©rifier les logs Next.js pour les erreurs webhook
3. VÃ©rifier que le `userId` est bien dans les mÃ©tadonnÃ©es de session
4. VÃ©rifier manuellement dans Prisma Studio

### ProblÃ¨me: Redirection infinie vers /subscription

**Cause:** Middleware dÃ©tecte pas l'abonnement actif

**Solution:**
1. VÃ©rifier en DB que `status` est bien "TRIALING" ou "ACTIVE"
2. VÃ©rifier que `hasActiveSubscription()` retourne true
3. Ajouter des logs dans `middleware.ts` pour dÃ©boguer
4. Se reconnecter (session peut Ãªtre obsolÃ¨te)

---

## Prochaines Ã‰tapes

Une fois tous les tests en dÃ©veloppement validÃ©s:

1. **Pousser le code:**
   ```bash
   git push origin main
   ```

2. **PrÃ©parer la production:**
   - Lire [DEPLOYMENT_CHECKLIST.md](./.specs/DEPLOYMENT_CHECKLIST.md)
   - Configurer Stripe en mode live
   - Configurer les variables Vercel

3. **DÃ©ployer:**
   - Merge sur `main` dÃ©clenche le dÃ©ploiement Vercel
   - Appliquer les migrations en production
   - Tester avec une vraie carte de test

---

## Ressources

- **Stripe Test Cards:** https://stripe.com/docs/testing
- **Stripe CLI Docs:** https://stripe.com/docs/stripe-cli
- **Resend Docs:** https://resend.com/docs
- **Playwright Docs:** https://playwright.dev

---

**Bon testing! ðŸ§ª**

Si vous rencontrez un problÃ¨me non couvert par ce guide, consultez [SUBSCRIPTION_ADMIN_GUIDE.md](./.specs/SUBSCRIPTION_ADMIN_GUIDE.md) ou ouvrez une issue.
